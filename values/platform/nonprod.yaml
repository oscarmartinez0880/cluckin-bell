# Nonprod (shared dev + qa) platform add-ons
global:
  clusterName: "cluckn-bell-nonprod"
  region: "us-east-1"
  environment: "nonprod"
  account: "264765154707"

platformAddons:
  awsLoadBalancerController:
    enabled: true
    namespace: kube-system
    chart:
      repo: https://aws.github.io/eks-charts
      name: aws-load-balancer-controller
      version: 1.7.2
    clusterName: cluckn-bell-nonprod
    serviceAccount:
      create: true
      name: aws-load-balancer-controller
      annotations:
        eks.amazonaws.com/role-arn: arn:aws:iam::264765154707:role/cluckn-bell-nonprod-aws-load-balancer-controller

  externalDNS:
    enabled: true
    namespace: external-dns
    chart:
      repo: https://kubernetes-sigs.github.io/external-dns/
      name: external-dns
      version: 1.14.5
    serviceAccount:
      create: true
      name: external-dns
      annotations:
        eks.amazonaws.com/role-arn: arn:aws:iam::264765154707:role/cluckn-bell-nonprod-external-dns
    txtOwnerId: cluckn-bell-nonprod
    domainFilters:
      - dev.cluckn-bell.com
      - qa.cluckn-bell.com
      - internal.dev.cluckn-bell.com
    extraArgs:
      - --policy=upsert-only
      - --log-format=text
      - --txt-prefix=_extdns
    resources:
      requests:
        cpu: 100m
        memory: 200Mi
      limits:
        cpu: 200m
        memory: 500Mi
    securityContext:
      runAsNonRoot: true
      runAsUser: 65534
      fsGroup: 65534
      allowPrivilegeEscalation: false
      readOnlyRootFilesystem: true
      capabilities:
        drop:
          - ALL

  certManager:
    enabled: false
    namespace: cert-manager
    chart:
      repo: https://charts.jetstack.io
      name: cert-manager
      version: v1.15.3
    installCRDs: true
    serviceAccount:
      annotations: {}

  metricsServer:
    enabled: true
    chart:
      repo: https://kubernetes-sigs.github.io/metrics-server/
      name: metrics-server
      version: 3.12.2

  kubePrometheusStack:
    enabled: true
    namespace: monitoring
    chart:
      repo: https://prometheus-community.github.io/helm-charts
      name: kube-prometheus-stack
      version: 62.6.0
    prometheus:
      prometheusSpec:
        retention: 7d
        resources:
          requests:
            cpu: 200m
            memory: 512Mi
          limits:
            cpu: 500m
            memory: 2Gi
    alertmanager:
      alertmanagerSpec:
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 200m
            memory: 256Mi
    grafana:
      enabled: true
      adminPassword: admin
      service:
        type: LoadBalancer
      resources:
        requests:
          cpu: 100m
          memory: 256Mi
        limits:
          cpu: 200m
          memory: 512Mi